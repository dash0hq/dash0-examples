# Traefik Helm Chart Configuration

# Use hostPort for Kind
ports:
  web:
    hostPort: 80
  websecure:
    hostPort: 443
  traefik:
    hostPort: 8080

# Node selector for ingress-ready node
nodeSelector:
  ingress-ready: "true"

# Tolerations for control-plane
tolerations:
  - key: node-role.kubernetes.io/control-plane
    operator: Equal
    effect: NoSchedule

# Enable dashboard
ingressRoute:
  dashboard:
    enabled: true

# API configuration
api:
  insecure: true

# Access logs configuration
logs:
  access:
    enabled: true
    format: json

# Metrics configuration
metrics:
  otlp:
    enabled: true
    http:
      enabled: true
      endpoint: http://otel-collector-opentelemetry-collector.opentelemetry.svc.cluster.local:4318/v1/metrics
    pushInterval: 10s
  # Disable Prometheus metrics (using OTLP instead)
  prometheus: null

# Tracing configuration
tracing:
  otlp:
    enabled: true
    http:
      enabled: true
      endpoint: http://otel-collector-opentelemetry-collector.opentelemetry.svc.cluster.local:4318/v1/traces

# Environment variables to fix OpenTelemetry resource detection
env:
  - name: USER
    value: "traefik"